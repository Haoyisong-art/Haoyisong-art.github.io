<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haoyi Song - Artist Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
            overflow-x: hidden;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            padding: 1rem 0;
            transition: transform 0.3s ease-in-out;
        }

        nav.hidden {
            transform: translateY(-100%);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
        }

        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            cursor: pointer;
        }

        nav a:hover {
            color: #8b4513;
        }

        /* Page Container */
        .page {
            display: none;
            padding: 5rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
            min-height: 100vh;
        }

        .page.active {
            display: block;
        }

        /* Home Page - Full Screen */
        #home {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            padding: 2rem;
            gap: 4rem;
        }

        #home.active {
            display: flex;
        }

        .home-center {
            flex: 1;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #home h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: #2c2c2c;
        }

        #home .subtitle {
            font-size: 1.3rem;
            color: #666;
            line-height: 1.8;
        }

        .home-statement {
            flex: 1;
            max-width: 600px;
            text-align: left;
        }

        .home-statement h2 {
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
            border: none;
            color: #8b4513;
            text-align: left;
        }

        .home-statement p {
            font-size: 0.85rem;
            line-height: 1.5;
            margin-bottom: 0.6rem;
            color: #666;
        }

        /* Section Styling */
        h2 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #2c2c2c;
            border-bottom: 3px solid #8b4513;
            padding-bottom: 0.5rem;
            display: inline-block;
        }

        h3 {
            font-size: 1.8rem;
            margin: 2rem 0 1rem;
            color: #8b4513;
        }

        p {
            margin-bottom: 1rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        /* Gallery Grid */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .artwork-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .artwork-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .artwork-placeholder {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #d4a574 0%, #8b6f47 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .artwork-info {
            padding: 1.5rem;
        }

        .artwork-info h4 {
            margin-bottom: 0.5rem;
            color: #2c2c2c;
        }

        /* Contact Section */
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.2rem;
        }

        .contact-item a {
            color: #8b4513;
            text-decoration: none;
            transition: color 0.3s;
        }

        .contact-item a:hover {
            color: #654321;
        }

        /* Experience Lists */
        .experience-list {
            margin-top: 2rem;
        }

        .experience-item {
            background: white;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .experience-item h4 {
            color: #8b4513;
            margin-bottom: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            nav ul {
                gap: 1rem;
                padding: 0 1rem;
            }

            #home {
                flex-direction: column;
                gap: 2rem;
            }

            #home h1 {
                font-size: 2.5rem;
            }

            #home .subtitle {
                font-size: 1.1rem;
            }

            .home-statement {
                max-width: 100%;
            }

            .home-statement p {
                font-size: 0.8rem;
            }

            h2 {
                font-size: 1.8rem;
            }

            .page {
                padding: 3rem 1rem;
            }

            .gallery-grid {
                grid-template-columns: 1fr;
            }

            /* Auto-hide navigation on mobile */
            nav {
                transform: translateY(-100%);
            }
            
            nav.show {
                transform: translateY(0);
            }
        }

        /* Back Button */
        .back-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 0.8rem 1.5rem;
            background-color: #888;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 999;
        }

        .back-button:hover {
            background-color: #666;
        }

        /* Spiritual Space / Prayer Styles */
        #spiritual {
            padding: 0;
            max-width: 100%;
        }

        #spiritual h2 {
            text-align: center;
            width: 100%;
            margin: 0 auto 2rem;
        }

        /* Hide navigation when spiritual page is active */
        #spiritual.active ~ nav,
        body:has(#spiritual.active) nav {
            display: none;
        }

        .prayer-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            margin: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 50%, #16213e 100%);
        }

        #backgroundVideo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
        }

        #particleCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
        }

        /* Pray Again button on top right */
        .pray-again-button {
            position: absolute;
            top: 2rem;
            right: 2rem;
            z-index: 10;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            display: none;
            opacity: 0;
        }

        .pray-again-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .prayer-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 4;
            padding: 2rem;
            transition: opacity 0.8s ease;
        }

        .prayer-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Darken video overlay for better particle visibility */
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 2;
            pointer-events: none;
        }

        .prayer-content {
            text-align: center;
            transition: all 0.5s ease;
        }

        .prayer-description {
            display: none;
        }

        .prayer-controls {
            margin: 0;
            transition: opacity 0.3s ease;
        }

        .prayer-button {
            background: rgba(255, 255, 255, 0.25);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.5);
            padding: 0.5rem 1.5rem;
            font-size: 0.9rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 400;
            backdrop-filter: blur(10px);
        }

        .prayer-button:hover {
            background: rgba(255, 255, 255, 0.35);
            border-color: rgba(255, 255, 255, 0.8);
            transform: scale(1.05);
        }

        .prayer-button:active {
            transform: scale(0.98);
        }

        .prayer-text {
            padding: 1.5rem;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .prayer-text p {
            color: #ffffff;
            line-height: 2;
            font-size: 1.3rem;
            margin: 0;
            font-style: italic;
            text-shadow: 0 3px 8px rgba(0,0,0,0.9);
            font-weight: 400;
        }

        /* Responsive adjustments for spiritual page */
        @media (max-width: 768px) {
            .prayer-container {
                height: 100vh;
                min-height: 500px;
            }

            .prayer-content {
                padding: 2rem 1.5rem;
                max-width: 90%;
            }

            .prayer-content h3 {
                font-size: 1.5rem;
            }

            .prayer-button {
                padding: 0.8rem 2rem;
                font-size: 1rem;
            }

            .prayer-text p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <ul>
            <li><a onclick="showPage('home')">Home</a></li>
            <li><a onclick="showPage('intro')">Background</a></li>
            <li><a onclick="showPage('research')">Research</a></li>
            <li><a onclick="showPage('paintings')">Paintings</a></li>
            <li><a onclick="showPage('installation')">Installation</a></li>
            <li><a onclick="showPage('teaching')">Teaching</a></li>
            <li><a onclick="showPage('events')">Events</a></li>
            <li><a onclick="showPage('contact')">Contact</a></li>
            <li><a onclick="showPage('spiritual')">My Spiritual Space</a></li>
        </ul>
    </nav>

    <!-- Home Page -->
    <div id="home" class="page active">
        <div class="home-center">
            <h1>Haoyi Song</h1>
            <div class="subtitle">
                <p>PhD Candidate, UTD</p>
                <p>Professional Artist</p>
            </div>
        </div>
        
        <div class="home-statement">
            <h2>Artist Statement</h2>
            <p>
                My work investigates how women's bodies become sites of emotional governance, where pain, discipline, and transformation are moralized and socially coded. I use everyday objects, beds, chairs, pillows, garments, as metaphors for endurance, containment, and relational spaces.
            </p>
            <p>
                Painting is integral to my practice: through transparency, erasure, repetition, and layered surfaces, I allow the canvas to become an archive, a memory, and a testimony. At the same time, I explore how different media articulate meaning in distinct ways.
            </p>
            <p>
                Grounded in cross-cultural perspectives, my art highlights both shared human experiences and cultural specificities in how bodies, identities, and emotional regimes are constructed.
            </p>
        </div>
    </div>

    <!-- Background/Intro Page -->
    <div id="intro" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Background</h2>
        <p>
            [Add additional biographical information, education, exhibitions, awards, or other background details here.]
        </p>
    </div>

    <!-- Research Page -->
    <div id="research" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Research</h2>
        <p>
            [Describe your research interests, artistic investigations, and theoretical frameworks 
            that inform your practice. Discuss the concepts you explore through your work.]
        </p>
        <p>
            [Add more details about your research methodology, influences, and ongoing investigations.]
        </p>
    </div>

    <!-- Paintings Page -->
    <div id="paintings" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Paintings</h2>

        <h3>Homeland</h3>
        <div class="gallery-grid">
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 1</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 2</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 3</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
        </div>

        <h3>Floating Dreams</h3>
        <div class="gallery-grid">
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 1</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 2</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 3</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
        </div>

        <h3>Daily Life</h3>
        <div class="gallery-grid">
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 1</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 2</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Artwork Image 3</div>
                <div class="artwork-info">
                    <h4>Artwork Title</h4>
                    <p>Medium, Dimensions, Year</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Installation Page -->
    <div id="installation" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Installation</h2>
        <div class="gallery-grid">
            <div class="artwork-card">
                <div class="artwork-placeholder">Installation Image 1</div>
                <div class="artwork-info">
                    <h4>Installation Title</h4>
                    <p>Materials, Dimensions, Year</p>
                </div>
            </div>
            <div class="artwork-card">
                <div class="artwork-placeholder">Installation Image 2</div>
                <div class="artwork-info">
                    <h4>Installation Title</h4>
                    <p>Materials, Dimensions, Year</p>
                </div>
            </div>
        </div>
    </div>

    <!-- My Spiritual Space Page -->
    <div id="spiritual" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <div class="prayer-container">
            <video id="backgroundVideo" autoplay loop muted playsinline>
                <source src="video.mp4" type="video/mp4">
            </video>
            <div class="video-overlay"></div>
            <canvas id="particleCanvas"></canvas>

            <button id="prayAgainButton" class="pray-again-button" onclick="restartPrayer()">Pray Again</button>

            <div class="prayer-overlay" id="prayerOverlay">
                <div class="prayer-content" id="prayerContent">
                    <div class="prayer-controls" id="prayButtons" style="display: flex; gap: 1.5rem; flex-wrap: wrap; justify-content: center; align-items: flex-start;">
                        <!-- Pray Group -->
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 15px; backdrop-filter: blur(10px);">
                            <button onclick="generatePrayer('en', 'pray')" class="prayer-button">Pray</button>
                            <button onclick="generatePrayer('zh', 'pray')" class="prayer-button">祈祷</button>
                        </div>

                        <!-- Relief Group -->
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 15px; backdrop-filter: blur(10px);">
                            <button onclick="generatePrayer('en', 'relief')" class="prayer-button">Relief</button>
                            <button onclick="generatePrayer('zh', 'relief')" class="prayer-button">消灾</button>
                        </div>
                    </div>

                    <div id="prayerText" class="prayer-text" style="display: none;">
                        <p></p>
                    </div>

                    <div id="additionalInput" style="display: none; margin-top: 1rem;">
                        <input type="text" id="additionalPrayer" placeholder="Add your own words..." style="padding: 0.5rem 1rem; width: 300px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.5); background: rgba(255,255,255,0.15); color: white; backdrop-filter: blur(10px); font-size: 0.9rem;">
                    </div>

<<<<<<< HEAD
                    <!-- Five Elements Selection - Circular Wheel -->
                    <div id="elementWheel" style="display: none; margin-top: 2rem; position: relative; width: 200px; height: 200px; margin-left: auto; margin-right: auto;">
                        <div class="element-emoji" data-element="metal" style="position: absolute; font-size: 2rem; cursor: pointer; transition: all 0.3s ease;">💰</div>
                        <div class="element-emoji" data-element="wood" style="position: absolute; font-size: 2rem; cursor: pointer; transition: all 0.3s ease;">🌳</div>
                        <div class="element-emoji" data-element="water" style="position: absolute; font-size: 2rem; cursor: pointer; transition: all 0.3s ease;">💧</div>
                        <div class="element-emoji" data-element="fire" style="position: absolute; font-size: 2rem; cursor: pointer; transition: all 0.3s ease;">🔥</div>
                        <div class="element-emoji" data-element="earth" style="position: absolute; font-size: 2rem; cursor: pointer; transition: all 0.3s ease;">⛰️</div>
=======
                    <!-- Five Elements Selection -->
                    <div class="prayer-controls" id="elementButtons" style="display: none; margin-top: 1.5rem;">
                        <div style="text-align: center; margin-bottom: 1rem;">
                            <p style="color: white; font-size: 0.9rem; opacity: 0.8;">Choose an element to connect:</p>
                        </div>
                        <div style="display: flex; gap: 0.8rem; flex-wrap: wrap; justify-content: center;">
                            <button onclick="connectWithElement('metal')" class="prayer-button" style="background: linear-gradient(135deg, rgba(192,192,192,0.3), rgba(220,220,220,0.3)); border-color: rgba(192,192,192,0.6);">
                                <div>Metal</div>
                                <div style="font-size: 1.2rem;">金</div>
                            </button>
                            <button onclick="connectWithElement('wood')" class="prayer-button" style="background: linear-gradient(135deg, rgba(34,139,34,0.3), rgba(50,205,50,0.3)); border-color: rgba(34,139,34,0.6);">
                                <div>Wood</div>
                                <div style="font-size: 1.2rem;">木</div>
                            </button>
                            <button onclick="connectWithElement('water')" class="prayer-button" style="background: linear-gradient(135deg, rgba(30,144,255,0.3), rgba(135,206,250,0.3)); border-color: rgba(30,144,255,0.6);">
                                <div>Water</div>
                                <div style="font-size: 1.2rem;">水</div>
                            </button>
                            <button onclick="connectWithElement('fire')" class="prayer-button" style="background: linear-gradient(135deg, rgba(255,69,0,0.3), rgba(255,140,0,0.3)); border-color: rgba(255,69,0,0.6);">
                                <div>Fire</div>
                                <div style="font-size: 1.2rem;">火</div>
                            </button>
                            <button onclick="connectWithElement('earth')" class="prayer-button" style="background: linear-gradient(135deg, rgba(139,69,19,0.3), rgba(210,180,140,0.3)); border-color: rgba(139,69,19,0.6);">
                                <div>Earth</div>
                                <div style="font-size: 1.2rem;">土</div>
                            </button>
                        </div>
>>>>>>> origin/main
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Teaching Experience Page -->
    <div id="teaching" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Teaching Experience</h2>
        <div class="experience-list">
            <div class="experience-item">
                <h4>Course/Position Title</h4>
                <p><strong>Institution Name</strong> | Year</p>
                <p>Description of teaching role, courses taught, and responsibilities.</p>
            </div>
            <div class="experience-item">
                <h4>Course/Position Title</h4>
                <p><strong>Institution Name</strong> | Year</p>
                <p>Description of teaching role, courses taught, and responsibilities.</p>
            </div>
            <div class="experience-item">
                <h4>Course/Position Title</h4>
                <p><strong>Institution Name</strong> | Year</p>
                <p>Description of teaching role, courses taught, and responsibilities.</p>
            </div>
        </div>
    </div>

    <!-- Directed Events Page -->
    <div id="events" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Directed Events</h2>
        <div class="experience-list">
            <div class="experience-item">
                <h4>Event Name</h4>
                <p><strong>Location</strong> | Date</p>
                <p>Description of the event, your role, and outcomes.</p>
            </div>
            <div class="experience-item">
                <h4>Event Name</h4>
                <p><strong>Location</strong> | Date</p>
                <p>Description of the event, your role, and outcomes.</p>
            </div>
            <div class="experience-item">
                <h4>Event Name</h4>
                <p><strong>Location</strong> | Date</p>
                <p>Description of the event, your role, and outcomes.</p>
            </div>
        </div>
    </div>

    <!-- Contact Page -->
    <div id="contact" class="page">
        <a class="back-button" onclick="showPage('home')">← Back to Home</a>
        <h2>Contact Me</h2>
        <div class="contact-info">
            <div class="contact-item">
                <strong>Email:</strong>
                <a href="mailto:your.email@example.com">your.email@example.com</a>
            </div>
            <div class="contact-item">
                <strong>Instagram:</strong>
                <a href="https://instagram.com/yourusername" target="_blank">@yourusername</a>
            </div>
            <div class="contact-item">
                <strong>Facebook:</strong>
                <a href="https://facebook.com/yourpage" target="_blank">Your Page Name</a>
            </div>
            <div class="contact-item">
                <strong>Twitter/X:</strong>
                <a href="https://twitter.com/yourusername" target="_blank">@yourusername</a>
            </div>
            <div class="contact-item">
                <strong>LinkedIn:</strong>
                <a href="https://linkedin.com/in/yourprofile" target="_blank">Your Name</a>
            </div>
        </div>
    </div>

    <script>
        // Mobile navigation auto-hide
        let lastScrollTop = 0;
        let touchStartY = 0;
        let isMobile = window.innerWidth <= 768;

        function handleNavigation() {
            if (!isMobile) return;
            const nav = document.querySelector('nav');
            const spiritualPage = document.getElementById('spiritual');
            if (spiritualPage && spiritualPage.classList.contains('active')) return;

            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (scrollTop > lastScrollTop && scrollTop > 100) {
                nav.classList.remove('show');
            } else {
                nav.classList.add('show');
            }
            lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
        }

        function handleTouchStart(e) {
            if (!isMobile) return;
            touchStartY = e.touches[0].clientY;
        }

        function handleTouchMove(e) {
            if (!isMobile) return;
            const nav = document.querySelector('nav');
            const touchY = e.touches[0].clientY;
            const diff = touchY - touchStartY;
            if (touchStartY < 50 && diff > 0) {
                nav.classList.add('show');
            } else if (diff < -30) {
                nav.classList.remove('show');
            }
        }

        function handleMouseMove(e) {
            if (!isMobile) return;
            const nav = document.querySelector('nav');
            const spiritualPage = document.getElementById('spiritual');
            if (spiritualPage && spiritualPage.classList.contains('active')) return;
            if (e.clientY < 50) {
                nav.classList.add('show');
            } else if (e.clientY > 150) {
                nav.classList.remove('show');
            }
        }

        window.addEventListener('resize', () => {
            isMobile = window.innerWidth <= 768;
            const nav = document.querySelector('nav');
            if (!isMobile) {
                nav.classList.remove('show');
                nav.style.transform = 'translateY(0)';
            }
        });

        window.addEventListener('scroll', handleNavigation);
        window.addEventListener('touchstart', handleTouchStart);
        window.addEventListener('touchmove', handleTouchMove);
        window.addEventListener('mousemove', handleMouseMove);

        // Particle System
        let canvas, ctx, particles = [], lines = [], animationId;

<<<<<<< HEAD
        // Mouse tracking for speed modulation (Relief mode only)
        let mouseX = 0, mouseY = 0, prevMouseX = 0, prevMouseY = 0;
        let mouseSpeed = 0;
        let speedMultiplier = 0; // Start completely static (no movement)

        // Element wheel rotation
        let wheelRotation = 0;
        let wheelRotating = true;
        let wheelAnimationId = null;

=======
>>>>>>> origin/main
        class Particle {
            constructor(char, x, y, type, charIndex) {
                this.char = char;
                this.startX = x;
                this.startY = y;
                this.x = x;
                this.y = y;
                this.type = type;
                this.charIndex = charIndex;
                this.size = Math.random() * 3 + 2; // Smaller particles
                this.opacity = 1;
                this.life = 1;
                this.trail = [];
<<<<<<< HEAD
                this.birthDelay = 0; // Frames to wait before becoming visible
                this.showChar = false; // Whether to show as character initially
                this.charToParticleProgress = 0; // 0 = character, 1 = particle
                this.age = 0; // How long the particle has been alive
=======
>>>>>>> origin/main

                if (type === 'wind') {
                    // Swirling wind effect
                    this.angle = Math.random() * Math.PI * 2;
                    this.radius = Math.random() * 50;
                    this.spiralSpeed = (Math.random() - 0.5) * 0.08;
                    this.radiusSpeed = Math.random() * 2 + 1;
                    this.orbitCenterX = x;
                    this.orbitCenterY = y;
                    this.color = `rgba(200, 220, 255, ${this.opacity})`;
                } else if (type === 'fire') {
                    // Rising fire particles
                    this.vx = (Math.random() - 0.5) * 2;
                    this.vy = -Math.random() * 4 - 2;
                    this.flicker = Math.random() * Math.PI;
                    this.flickerSpeed = Math.random() * 0.3 + 0.2;
                    this.hue = Math.random() * 60; // Orange to yellow
                } else if (type === 'water') {
                    // Flowing water particles
                    this.vx = (Math.random() - 0.5) * 3;
                    this.vy = Math.random() * 0.5 - 2;
                    this.wave = Math.random() * Math.PI * 2;
                    this.waveSpeed = Math.random() * 0.15 + 0.1;
                    this.waveAmplitude = Math.random() * 4 + 2;
                } else if (type === 'floating') {
                    // Gentle floating upward
                    this.vx = (Math.random() - 0.5) * 1;
                    this.vy = -Math.random() * 1.5 - 0.5;
                    this.drift = Math.random() * Math.PI * 2;
                    this.driftSpeed = Math.random() * 0.05 + 0.02;
                } else if (type === 'light') {
                    // Radiating light
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 4 + 2;
                    this.glow = 1;
                    this.pulseSpeed = Math.random() * 0.1 + 0.05;
                } else if (type === 'smoke') {
<<<<<<< HEAD
                    // Fading smoke falling slowly
                    this.vx = (Math.random() - 0.5) * 1;
                    this.vy = Math.random() * 0.5 + 0.3; // Slow downward drift
                    this.expansion = 1;
                    this.expansionSpeed = Math.random() * 0.03 + 0.02;
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotSpeed = (Math.random() - 0.5) * 0.05;
                    this.drift = Math.random() * Math.PI * 2;
                    this.driftSpeed = Math.random() * 0.08 + 0.05;
                    this.fadeStage = 0; // 0 = dark smoke, 1 = faded
                    this.fadeSpeed = Math.random() * 0.006 + 0.004;
=======
                    // Heavy smoke falling
                    this.vx = (Math.random() - 0.5) * 2;
                    this.vy = Math.random() * 2 + 1;
                    this.expansion = 1;
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotSpeed = (Math.random() - 0.5) * 0.1;
>>>>>>> origin/main
                } else if (type === 'shatter') {
                    // Glass shattering effect
                    this.vx = (Math.random() - 0.5) * 8;
                    this.vy = (Math.random() - 0.5) * 8;
                    this.gravity = 0.3;
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotSpeed = (Math.random() - 0.5) * 0.3;
                    this.edges = Math.floor(Math.random() * 3) + 3;
                } else if (type === 'crash') {
                    // Explosive crash particles
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 6 + 3;
                    this.vx = Math.cos(this.angle) * this.speed;
                    this.vy = Math.sin(this.angle) * this.speed;
                    this.gravity = 0.2;
                    this.bounce = 0.6;
                } else if (type === 'metal') {
                    // Metallic particles - spiraling upward with expansion
                    this.angle = Math.random() * Math.PI * 2;
                    this.spiralRadius = Math.random() * 20;
                    this.spiralSpeed = (Math.random() - 0.5) * 0.1;
                    this.upwardSpeed = Math.random() * 2 + 1;
                    this.shimmer = Math.random() * Math.PI * 2;
                    this.shimmerSpeed = Math.random() * 0.2 + 0.1;
                    this.metalColor = Math.random() > 0.5 ? 'silver' : 'gold';
                    this.expansion = 1;
                    this.expansionSpeed = Math.random() * 0.015 + 0.01;
                } else if (type === 'wood') {
                    // Wood particles - swirling upward like leaves
                    this.vx = (Math.random() - 0.5) * 2;
                    this.vy = -Math.random() * 2.5 - 1.5;
                    this.swirl = Math.random() * Math.PI * 2;
                    this.swirlSpeed = Math.random() * 0.15 + 0.1;
                    this.swirlRadius = Math.random() * 3 + 2;
                    this.growth = 1;
                    this.growthSpeed = Math.random() * 0.02 + 0.01;
                    this.branchAngle = (Math.random() - 0.5) * 0.5;
                    this.lift = 0;
                } else if (type === 'earth') {
                    // Earth particles - floating upward with gentle drift
                    this.vx = (Math.random() - 0.5) * 1;
                    this.vy = -Math.random() * 2 - 1;
                    this.float = Math.random() * Math.PI * 2;
                    this.floatSpeed = Math.random() * 0.08 + 0.05;
                    this.floatAmplitude = Math.random() * 2 + 1;
                    this.earthColor = Math.floor(Math.random() * 3);
                    this.expansion = 1;
                    this.expansionSpeed = Math.random() * 0.02 + 0.01;
                } else if (type === 'wood-break') {
<<<<<<< HEAD
                    // Splintering wood - slow fall
                    this.vx = (Math.random() - 0.5) * 1.5; // Reduced from 6
                    this.vy = Math.random() * 0.5; // Reduced from 6, starts slow
                    this.gravity = 0.08; // Reduced from 0.25
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotSpeed = (Math.random() - 0.5) * 0.08; // Reduced from 0.4
                    this.length = Math.random() * 10 + 5;
                    this.drift = Math.random() * Math.PI * 2;
                    this.driftSpeed = Math.random() * 0.04 + 0.02;
                } else if (type === 'flood') {
                    // Slowly dripping/flowing water
                    this.vx = (Math.random() - 0.5) * 1; // Reduced from 5
                    this.vy = Math.random() * 0.6 + 0.3; // Reduced from 4+2
                    this.wave = Math.random() * Math.PI * 2;
                    this.waveSpeed = Math.random() * 0.08 + 0.05; // Reduced from 0.2+0.15
                } else if (type === 'burn') {
                    // Burning to ash - starts as fire, turns to ash falling down
                    this.vx = (Math.random() - 0.5) * 0.8; // Reduced from 1.5
                    this.vy = 0; // Start stationary
                    this.burnStage = 0; // 0 = fire, 1 = ash
                    this.flicker = Math.random() * Math.PI;
                    this.flickerSpeed = Math.random() * 0.25 + 0.15; // Slightly reduced
                    this.fallSpeed = Math.random() * 0.25 + 0.15; // Reduced from 0.3+0.2
                    this.drift = Math.random() * Math.PI * 2;
                    this.driftSpeed = Math.random() * 0.04 + 0.02; // Slightly reduced
                } else if (type === 'earth-crack') {
                    // Slowly crumbling earth particles
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 0.8 + 0.3; // Reduced from 3+1
                    this.vx = Math.cos(this.angle) * this.speed;
                    this.vy = Math.sin(this.angle) * this.speed;
                    this.gravity = 0.05; // Reduced from 0.15
                    this.settled = false;
                    this.drift = Math.random() * Math.PI * 2;
                    this.driftSpeed = Math.random() * 0.03 + 0.01;
=======
                    // Splintering wood
                    this.vx = (Math.random() - 0.5) * 6;
                    this.vy = (Math.random() - 0.5) * 6;
                    this.gravity = 0.25;
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotSpeed = (Math.random() - 0.5) * 0.4;
                    this.length = Math.random() * 10 + 5;
                } else if (type === 'flood') {
                    // Rushing water
                    this.vx = (Math.random() - 0.5) * 5;
                    this.vy = Math.random() * 4 + 2;
                    this.wave = Math.random() * Math.PI * 2;
                    this.waveSpeed = Math.random() * 0.2 + 0.15;
                } else if (type === 'burn') {
                    // Burning/ash particles
                    this.vx = (Math.random() - 0.5) * 2;
                    this.vy = -Math.random() * 5 - 3;
                    this.burnStage = Math.random();
                    this.flicker = Math.random() * Math.PI;
                    this.flickerSpeed = Math.random() * 0.4 + 0.2;
                } else if (type === 'earth-crack') {
                    // Cracking earth particles
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 3 + 1;
                    this.vx = Math.cos(this.angle) * this.speed;
                    this.vy = Math.sin(this.angle) * this.speed;
                    this.gravity = 0.15;
                    this.settled = false;
>>>>>>> origin/main
                }
            }

            update() {
<<<<<<< HEAD
                // Handle birth delay
                if (this.birthDelay > 0) {
                    this.birthDelay--;
                    return; // Don't update or show particle yet
                }

                this.age++;

                // Gradual transformation from character to particle (over 90 frames / 1.5 seconds)
                if (this.showChar && this.charToParticleProgress < 1) {
                    this.charToParticleProgress += 0.011; // Reach 1.0 after ~90 frames
                }

=======
>>>>>>> origin/main
                if (this.type === 'wind') {
                    this.angle += this.spiralSpeed;
                    this.radius += this.radiusSpeed;
                    this.x = this.orbitCenterX + Math.cos(this.angle) * this.radius;
                    this.y = this.orbitCenterY + Math.sin(this.angle) * this.radius;
                    this.orbitCenterY -= 1; // Drift upward
                } else if (this.type === 'fire') {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.vy *= 0.98;
                    this.vx *= 0.95;
                    this.flicker += this.flickerSpeed;
                } else if (this.type === 'water') {
                    this.wave += this.waveSpeed;
                    this.x += this.vx + Math.sin(this.wave) * this.waveAmplitude;
                    this.y += this.vy;
                } else if (this.type === 'floating') {
                    this.drift += this.driftSpeed;
                    this.x += this.vx + Math.sin(this.drift) * 0.5;
                    this.y += this.vy;
                } else if (this.type === 'light') {
                    this.x += Math.cos(this.angle) * this.speed;
                    this.y += Math.sin(this.angle) * this.speed;
                    this.glow = 0.5 + Math.sin(this.life * Math.PI * 2) * 0.5;
                } else if (this.type === 'smoke') {
<<<<<<< HEAD
                    // Drifting smoke falling slowly and fading
                    this.drift += this.driftSpeed;
                    this.x += this.vx + Math.sin(this.drift) * 1.5;
                    this.y += this.vy;
                    this.vx *= 0.98;
                    this.expansion += this.expansionSpeed;
                    this.rotation += this.rotSpeed;
                    this.fadeStage += this.fadeSpeed;

                    // Slow down falling as it expands and fades
                    this.vy *= 0.99;
=======
                    this.x += this.vx;
                    this.y += this.vy;
                    this.vx *= 0.98;
                    this.expansion += 0.03;
                    this.rotation += this.rotSpeed;
>>>>>>> origin/main
                } else if (this.type === 'shatter') {
                    this.vy += this.gravity;
                    this.x += this.vx;
                    this.y += this.vy;
                    this.vx *= 0.98;
                    this.rotation += this.rotSpeed;
                } else if (this.type === 'crash') {
                    this.vy += this.gravity;
                    this.x += this.vx;
                    this.y += this.vy;
                    this.vx *= 0.99;
                    if (this.y > canvas.height - 20) {
                        this.vy *= -this.bounce;
                        this.y = canvas.height - 20;
                        this.bounce *= 0.8;
                    }
                } else if (this.type === 'metal') {
                    // Spiral upward with expansion
                    this.angle += this.spiralSpeed;
                    this.y -= this.upwardSpeed;
                    this.x += Math.cos(this.angle) * this.spiralRadius;
                    this.spiralRadius += 0.3; // Expand spiral
                    this.shimmer += this.shimmerSpeed;
                    this.expansion += this.expansionSpeed;
                } else if (this.type === 'wood') {
                    // Swirling upward like rising leaves
                    this.swirl += this.swirlSpeed;
                    this.x += this.vx + Math.cos(this.swirl) * this.swirlRadius;
                    this.y += this.vy;
                    this.vy -= 0.03; // Accelerate upward
                    this.growth += this.growthSpeed;
                    this.branchAngle += 0.02;
                    this.lift += 0.02;
                    this.swirlRadius += 0.05; // Expand swirl
                } else if (this.type === 'earth') {
                    // Floating upward with drift
                    this.float += this.floatSpeed;
                    this.x += this.vx + Math.sin(this.float) * this.floatAmplitude;
                    this.y += this.vy;
                    this.vy -= 0.02; // Gentle lift
                    this.expansion += this.expansionSpeed;
                } else if (this.type === 'wood-break') {
<<<<<<< HEAD
                    this.vy += this.gravity * speedMultiplier;
                    this.x += this.vx * speedMultiplier;
                    this.y += this.vy * speedMultiplier;
                    this.rotation += this.rotSpeed * speedMultiplier;
                    this.vx *= 0.97;
                } else if (this.type === 'flood') {
                    this.wave += this.waveSpeed * speedMultiplier;
                    this.x += this.vx * speedMultiplier;
                    this.y += this.vy * speedMultiplier;
                } else if (this.type === 'burn') {
                    this.flicker += this.flickerSpeed * speedMultiplier;
                    this.burnStage += 0.008 * speedMultiplier; // Slow burn transition

                    // Transition from fire (stationary) to falling ash
                    if (this.burnStage < 0.3) {
                        // Fire stage - slight flickering movement
                        this.vx += (Math.random() - 0.5) * 0.1 * speedMultiplier;
                        this.vy += (Math.random() - 0.5) * 0.1 * speedMultiplier;
                        this.vx *= 0.95;
                        this.vy *= 0.95;
                    } else if (this.burnStage < 0.5) {
                        // Transition stage - start falling slowly
                        this.vy += this.fallSpeed * 0.5 * speedMultiplier;
                        this.drift += this.driftSpeed * speedMultiplier;
                        this.x += Math.sin(this.drift) * 0.3 * speedMultiplier;
                    } else {
                        // Ash stage - falling slowly with drift
                        this.vy = (this.fallSpeed + (this.burnStage - 0.5) * 0.5) * speedMultiplier; // Gradually fall faster
                        this.drift += this.driftSpeed * speedMultiplier;
                        this.x += Math.sin(this.drift) * 0.5 * speedMultiplier;
                    }

                    this.x += this.vx * speedMultiplier;
                    this.y += this.vy * speedMultiplier;
                } else if (this.type === 'earth-crack') {
                    this.vy += this.gravity * speedMultiplier;
                    this.x += this.vx * speedMultiplier;
                    this.y += this.vy * speedMultiplier;
=======
                    this.vy += this.gravity;
                    this.x += this.vx;
                    this.y += this.vy;
                    this.rotation += this.rotSpeed;
                    this.vx *= 0.97;
                } else if (this.type === 'flood') {
                    this.wave += this.waveSpeed;
                    this.x += this.vx;
                    this.y += this.vy;
                } else if (this.type === 'burn') {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.flicker += this.flickerSpeed;
                    this.vy *= 0.96;
                    this.burnStage += 0.01;
                } else if (this.type === 'earth-crack') {
                    this.vy += this.gravity;
                    this.x += this.vx;
                    this.y += this.vy;
>>>>>>> origin/main
                    this.vx *= 0.95;
                    if (this.y > canvas.height - 30) {
                        this.settled = true;
                        this.vy = 0;
                        this.vx = 0;
                    }
                }

                // Store trail for certain effects
                if (this.type === 'fire' || this.type === 'light' || this.type === 'water') {
                    this.trail.push({x: this.x, y: this.y, opacity: this.opacity});
                    if (this.trail.length > 10) this.trail.shift();
                }

<<<<<<< HEAD
                this.life -= 0.0015; // Slower fade (was 0.006) - particles last ~5.5 seconds
=======
                this.life -= 0.006;
>>>>>>> origin/main
                this.opacity = Math.max(0, this.life);
            }

            draw() {
<<<<<<< HEAD
                // Don't draw if still in birth delay
                if (this.birthDelay > 0) return;

                ctx.save();

                // Draw character first if it's transforming
                if (this.showChar && this.charToParticleProgress < 1) {
                    const charOpacity = (1 - this.charToParticleProgress) * this.opacity;
                    ctx.globalAlpha = charOpacity;
                    ctx.font = `${24 * (1 - this.charToParticleProgress * 0.5)}px Georgia`; // Shrink as it transforms
                    ctx.fillStyle = '#ffffff';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(this.char, this.x, this.y);
                    ctx.restore();
                    ctx.save();
                }

                // Draw particle effects with increasing opacity as transformation progresses
                const particleOpacity = this.showChar ? this.charToParticleProgress * this.opacity : this.opacity;
                ctx.globalAlpha = particleOpacity;

=======
                ctx.save();

>>>>>>> origin/main
                // Draw trails
                if (this.trail.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(this.trail[0].x, this.trail[0].y);
                    for (let i = 1; i < this.trail.length; i++) {
                        ctx.lineTo(this.trail[i].x, this.trail[i].y);
                    }
                    ctx.strokeStyle = this.getColor();
                    ctx.lineWidth = this.size * 0.5;
                    ctx.globalAlpha = this.opacity * 0.3;
                    ctx.stroke();
                }

<<<<<<< HEAD
                // globalAlpha already set above based on transformation progress
=======
                ctx.globalAlpha = this.opacity;
>>>>>>> origin/main
                ctx.translate(this.x, this.y);

                if (this.type === 'wind') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = 'rgba(200, 220, 255, 0.5)';
                    ctx.fill();
                } else if (this.type === 'fire') {
                    const intensity = 0.7 + Math.sin(this.flicker) * 0.3;
                    const hue = this.hue * intensity;
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * (1 + intensity * 0.5), 0, Math.PI * 2);
                    ctx.fillStyle = `hsla(${hue}, 100%, ${50 + intensity * 20}%, ${this.opacity})`;
                    ctx.shadowBlur = 25;
                    ctx.shadowColor = `hsla(${hue}, 100%, 50%, 0.8)`;
                    ctx.fill();
                } else if (this.type === 'water') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(100, 180, 255, ${this.opacity * 0.8})`;
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = 'rgba(100, 180, 255, 0.5)';
                    ctx.fill();
                } else if (this.type === 'floating') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity * 0.7})`;
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = 'rgba(255, 255, 255, 0.5)';
                    ctx.fill();
                } else if (this.type === 'light') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * (1 + this.glow), 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 200, ${this.opacity})`;
                    ctx.shadowBlur = 30 * this.glow;
                    ctx.shadowColor = 'rgba(255, 255, 200, 0.8)';
                    ctx.fill();
                } else if (this.type === 'smoke') {
                    ctx.rotate(this.rotation);
                    ctx.scale(this.expansion, this.expansion);
<<<<<<< HEAD

                    // Calculate smoke color - starts darker, fades to lighter gray
                    const smokeDarkness = 60 + this.fadeStage * 100; // 60 (dark) to 160 (light gray)
                    const smokeAlpha = this.opacity * (0.7 - this.fadeStage * 0.5); // Fade out

                    // Draw multiple layers for billowing smoke effect
                    // Outer layer - very faint
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * 2, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${smokeDarkness + 30}, ${smokeDarkness + 30}, ${smokeDarkness + 30}, ${smokeAlpha * 0.15})`;
                    ctx.filter = `blur(${5 + this.expansion * 2}px)`;
                    ctx.fill();

                    // Middle layer
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * 1.3, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${smokeDarkness + 15}, ${smokeDarkness + 15}, ${smokeDarkness + 15}, ${smokeAlpha * 0.35})`;
                    ctx.filter = `blur(${3 + this.expansion}px)`;
                    ctx.fill();

                    // Core layer - most visible
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${smokeDarkness}, ${smokeDarkness}, ${smokeDarkness}, ${smokeAlpha * 0.6})`;
                    ctx.filter = `blur(${2 + this.expansion * 0.5}px)`;
=======
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(80, 80, 80, ${this.opacity * 0.6})`;
                    ctx.filter = 'blur(3px)';
>>>>>>> origin/main
                    ctx.fill();
                } else if (this.type === 'shatter') {
                    ctx.rotate(this.rotation);
                    ctx.beginPath();
                    for (let i = 0; i < this.edges; i++) {
                        const angle = (i / this.edges) * Math.PI * 2;
                        const x = Math.cos(angle) * this.size * 2;
                        const y = Math.sin(angle) * this.size * 2;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                    ctx.strokeStyle = `rgba(200, 220, 255, ${this.opacity})`;
                    ctx.lineWidth = 1;
                    ctx.stroke();
                } else if (this.type === 'crash') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 100, 50, ${this.opacity})`;
                    ctx.fill();
                } else if (this.type === 'metal') {
                    const shimmerVal = Math.sin(this.shimmer) * 0.5 + 0.5;
                    const color = this.metalColor === 'silver' ?
                        `rgba(${192 + shimmerVal * 63}, ${192 + shimmerVal * 63}, ${192 + shimmerVal * 63}, ${this.opacity})` :
                        `rgba(${255}, ${215 + shimmerVal * 40}, ${0}, ${this.opacity})`;

                    // Draw expanding glow trail
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * this.expansion, 0, Math.PI * 2);
                    ctx.fillStyle = color.replace(this.opacity, this.opacity * 0.3);
                    ctx.shadowBlur = 30 * this.expansion;
                    ctx.shadowColor = color;
                    ctx.fill();

                    // Draw core particle
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * (1 + this.expansion * 0.3), 0, Math.PI * 2);
                    ctx.fillStyle = color;
                    ctx.shadowBlur = 25;
                    ctx.shadowColor = color;
                    ctx.fill();
                } else if (this.type === 'wood') {
                    ctx.save();
                    ctx.rotate(this.branchAngle);

                    // Draw expanding leaf shape
                    const leafSize = this.size * (1 + this.growth * 0.5);
                    ctx.beginPath();
                    ctx.ellipse(0, 0, leafSize * 0.6, leafSize * 1.2, 0, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(34, 139, 34, ${this.opacity * 0.7})`;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = `rgba(50, 205, 50, ${this.opacity * 0.5})`;
                    ctx.fill();

                    // Add glow for uplifting effect
                    ctx.beginPath();
                    ctx.ellipse(0, 0, leafSize * 0.8, leafSize * 1.4, 0, 0, Math.PI * 2);
                    ctx.strokeStyle = `rgba(50, 205, 50, ${this.opacity * 0.3})`;
                    ctx.lineWidth = 2;
                    ctx.stroke();

                    ctx.restore();
                } else if (this.type === 'earth') {
                    const earthColors = [
                        `rgba(139, 69, 19, ${this.opacity})`,
                        `rgba(160, 82, 45, ${this.opacity})`,
                        `rgba(210, 180, 140, ${this.opacity})`
                    ];

                    // Draw expanding dust cloud
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * this.expansion * 1.5, 0, Math.PI * 2);
                    ctx.fillStyle = earthColors[this.earthColor].replace(this.opacity, this.opacity * 0.2);
                    ctx.fill();

                    // Draw core particle
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * (1 + this.expansion * 0.2), 0, Math.PI * 2);
                    ctx.fillStyle = earthColors[this.earthColor];
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = earthColors[this.earthColor];
                    ctx.fill();
                } else if (this.type === 'wood-break') {
                    ctx.rotate(this.rotation);
                    ctx.beginPath();
                    ctx.rect(-this.size * 0.5, -this.length / 2, this.size, this.length);
                    ctx.fillStyle = `rgba(139, 69, 19, ${this.opacity})`;
                    ctx.strokeStyle = `rgba(101, 67, 33, ${this.opacity})`;
                    ctx.lineWidth = 1;
                    ctx.fill();
                    ctx.stroke();
                } else if (this.type === 'flood') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size * 1.5, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(30, 144, 255, ${this.opacity * 0.6})`;
                    ctx.shadowBlur = 8;
                    ctx.shadowColor = 'rgba(30, 144, 255, 0.4)';
                    ctx.fill();
                } else if (this.type === 'burn') {
<<<<<<< HEAD
                    const intensity = 0.5 + Math.sin(this.flicker) * 0.5;

                    if (this.burnStage < 0.3) {
                        // Fire stage - bright orange/red flames
                        const fireHue = 20 + Math.random() * 20; // Orange to red
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size * (1 + intensity * 0.5), 0, Math.PI * 2);
                        ctx.fillStyle = `hsla(${fireHue}, 100%, ${60 + intensity * 20}%, ${this.opacity})`;
                        ctx.shadowBlur = 25;
                        ctx.shadowColor = `hsla(${fireHue}, 100%, 50%, 0.8)`;
                        ctx.fill();

                        // Add flame glow
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size * (2 + intensity), 0, Math.PI * 2);
                        ctx.fillStyle = `hsla(${fireHue}, 100%, 50%, ${this.opacity * 0.2})`;
                        ctx.fill();
                    } else if (this.burnStage < 0.5) {
                        // Burning stage - transitioning to gray
                        const burnProgress = (this.burnStage - 0.3) / 0.2; // 0 to 1
                        const burnHue = 20 * (1 - burnProgress); // Orange fading to gray
                        const saturation = 100 * (1 - burnProgress);
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                        ctx.fillStyle = `hsla(${burnHue}, ${saturation}%, 40%, ${this.opacity})`;
                        ctx.shadowBlur = 15 * (1 - burnProgress);
                        ctx.shadowColor = `hsla(${burnHue}, ${saturation}%, 40%, 0.5)`;
                        ctx.fill();
                    } else {
                        // Ash stage - dark gray particles falling
                        const ashDarkness = 40 + (this.burnStage - 0.5) * 40; // Darker as it falls
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size * 0.8, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(${ashDarkness}, ${ashDarkness}, ${ashDarkness}, ${this.opacity * 0.8})`;
                        ctx.shadowBlur = 3;
                        ctx.shadowColor = `rgba(${ashDarkness}, ${ashDarkness}, ${ashDarkness}, 0.4)`;
                        ctx.fill();

                        // Add slight ash dust cloud
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size * 1.5, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(${ashDarkness + 20}, ${ashDarkness + 20}, ${ashDarkness + 20}, ${this.opacity * 0.15})`;
                        ctx.fill();
                    }
=======
                    const burnHue = Math.max(0, 60 - this.burnStage * 60);
                    const intensity = 0.5 + Math.sin(this.flicker) * 0.5;
                    if (this.burnStage < 0.7) {
                        ctx.fillStyle = `hsla(${burnHue}, 100%, ${50 + intensity * 30}%, ${this.opacity})`;
                    } else {
                        ctx.fillStyle = `rgba(80, 80, 80, ${this.opacity * (1 - this.burnStage)})`;
                    }
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.shadowBlur = this.burnStage < 0.7 ? 20 : 5;
                    ctx.shadowColor = this.burnStage < 0.7 ? `hsla(${burnHue}, 100%, 50%, 0.8)` : 'rgba(80, 80, 80, 0.5)';
                    ctx.fill();
>>>>>>> origin/main
                } else if (this.type === 'earth-crack') {
                    ctx.beginPath();
                    for (let i = 0; i < 4; i++) {
                        const angle = (i / 4) * Math.PI * 2;
                        const x = Math.cos(angle) * this.size * 1.5;
                        const y = Math.sin(angle) * this.size * 1.5;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                    ctx.fillStyle = `rgba(101, 67, 33, ${this.opacity})`;
                    ctx.strokeStyle = `rgba(139, 69, 19, ${this.opacity})`;
                    ctx.lineWidth = 1;
                    ctx.fill();
                    ctx.stroke();
                }

                ctx.restore();
            }

            getColor() {
                if (this.type === 'fire') {
                    return `hsla(${this.hue}, 100%, 50%, ${this.opacity})`;
                } else if (this.type === 'water') {
                    return `rgba(100, 180, 255, ${this.opacity})`;
                } else if (this.type === 'light') {
                    return `rgba(255, 255, 200, ${this.opacity})`;
                }
                return `rgba(255, 255, 255, ${this.opacity})`;
            }
        }

        function initCanvas() {
            canvas = document.getElementById('particleCanvas');
            if (!canvas) return;
            ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function createParticles(text, type) {
            particles = [];
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;

<<<<<<< HEAD
            // Create screen-immersive particles - based on screen area, not character count
            const totalParticles = Math.floor((canvas.width * canvas.height) / 3000); // ~1 particle per 3000 pixels

            // First create text character particles in the center
            const textChars = text.split('').filter(c => c.trim());
            const charParticles = textChars.length * 3; // 3 particles per character initially

            // Place character-based particles in a circle formation
            textChars.forEach((c, i) => {
                const angle = (i / textChars.length) * Math.PI * 2;
                const baseX = cx + Math.cos(angle) * 150;
                const baseY = cy + Math.sin(angle) * 150;

                for (let j = 0; j < 3; j++) {
                    const offsetX = (Math.random() - 0.5) * 30;
                    const offsetY = (Math.random() - 0.5) * 30;
                    const particle = new Particle(c, baseX + offsetX, baseY + offsetY, type, i);
                    particle.birthDelay = Math.random() * 60; // Gradual appearance over 60 frames (~1 second)
                    particle.showChar = true; // Start as character
                    particle.charToParticleProgress = 0; // 0 = character, 1 = full particle
                    particles.push(particle);
                }
            });

            // Then fill the rest of the screen with ambient particles (no characters)
            const ambientParticles = totalParticles - charParticles;
            for (let i = 0; i < ambientParticles; i++) {
                // Random position across entire screen
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const particle = new Particle('', x, y, type, -1);
                particle.birthDelay = Math.random() * 120; // Staggered birth over 2 seconds
                particle.showChar = false; // No character, pure particle
                particle.charToParticleProgress = 1; // Already a particle
                particles.push(particle);
            }
        }

        function trackMouseSpeed(e) {
            prevMouseX = mouseX;
            prevMouseY = mouseY;
            mouseX = e.clientX;
            mouseY = e.clientY;

            // Calculate distance moved
            const dx = mouseX - prevMouseX;
            const dy = mouseY - prevMouseY;
            const distance = Math.sqrt(dx * dx + dy * dy);

            // Update mouse speed (more responsive, less smoothing)
            mouseSpeed = mouseSpeed * 0.2 + distance * 0.8; // Very responsive to mouse

            // Calculate speed multiplier: 0 when no movement, up to 3.0 when moving fast
            // Only affects Relief mode particles - more dramatic interaction
            speedMultiplier = Math.min(mouseSpeed / 50, 3.0); // Higher sensitivity and max speed
        }

        function animateElementWheel() {
            if (!wheelRotating) return;

            const wheel = document.getElementById('elementWheel');
            if (!wheel || wheel.style.display === 'none') return;

            wheelRotation += 0.01; // Slow rotation speed

            const emojis = wheel.querySelectorAll('.element-emoji');
            const radius = 80; // Distance from center
            const centerX = 100; // Half of wheel width
            const centerY = 100; // Half of wheel height

            emojis.forEach((emoji, index) => {
                const angle = wheelRotation + (index * (Math.PI * 2) / 5);
                const x = centerX + Math.cos(angle) * radius - 16; // -16 for emoji centering
                const y = centerY + Math.sin(angle) * radius - 16;

                emoji.style.left = x + 'px';
                emoji.style.top = y + 'px';
            });

            wheelAnimationId = requestAnimationFrame(animateElementWheel);
        }

        function initElementWheelInteractions() {
            const emojis = document.querySelectorAll('.element-emoji');
            emojis.forEach(emoji => {
                emoji.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const element = this.getAttribute('data-element');
                    wheelRotating = false; // Stop rotation
                    if (wheelAnimationId) cancelAnimationFrame(wheelAnimationId);
                    connectWithElement(element);
                });

                // Hover effect - stop rotation and glow
                emoji.addEventListener('mouseenter', function() {
                    wheelRotating = false;
                    if (wheelAnimationId) cancelAnimationFrame(wheelAnimationId);
                    this.style.transform = 'scale(1.5)';
                    this.style.filter = 'drop-shadow(0 0 15px rgba(255,255,255,1))';
                });

                emoji.addEventListener('mouseleave', function() {
                    wheelRotating = true;
                    animateElementWheel();
                    this.style.transform = 'scale(1)';
                    this.style.filter = 'none';
                });
            });
=======
            // Create multiple particles per character for more vivid effect
            const particlesPerChar = 5;

            text.split('').forEach((c, i) => {
                if (c.trim()) {
                    const angle = (i / text.length) * Math.PI * 2;
                    const baseX = cx + Math.cos(angle) * 150;
                    const baseY = cy + Math.sin(angle) * 150;

                    // Create cluster of particles for each character
                    for (let j = 0; j < particlesPerChar; j++) {
                        const offsetX = (Math.random() - 0.5) * 30;
                        const offsetY = (Math.random() - 0.5) * 30;
                        particles.push(new Particle(c, baseX + offsetX, baseY + offsetY, type, i));
                    }
                }
            });
>>>>>>> origin/main
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
<<<<<<< HEAD

            // Rapidly decay mouse speed to make particles stop quickly when mouse stops
            mouseSpeed *= 0.80; // Faster decay = quicker stop
            speedMultiplier = Math.min(mouseSpeed / 50, 3.0); // Match the tracking sensitivity

=======
>>>>>>> origin/main
            particles = particles.filter(p => {
                p.update();
                p.draw();
                return p.life > 0;
            });
            if (particles.length > 0) requestAnimationFrame(animate);
        }

        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
                page.style.display = 'none';
            });

            const selectedPage = document.getElementById(pageId);
            selectedPage.classList.add('active');
            const nav = document.querySelector('nav');

            if (pageId === 'home') {
                selectedPage.style.display = 'flex';
                nav.style.display = 'block';
            } else if (pageId === 'spiritual') {
                selectedPage.style.display = 'block';
                nav.style.display = 'none';

                // Ensure video is visible when entering spiritual page
                document.getElementById('backgroundVideo').style.display = 'block';
                document.querySelector('.video-overlay').style.display = 'block';
                document.querySelector('.prayer-container').style.background = 'linear-gradient(135deg, #1a1a2e 0%, #0f3460 50%, #16213e 100%)';

<<<<<<< HEAD
                // Add mouse tracking for Relief mode speed control
                document.addEventListener('mousemove', trackMouseSpeed);

=======
>>>>>>> origin/main
                setTimeout(() => initCanvas(), 100);
            } else {
                selectedPage.style.display = 'block';
                nav.style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        let currentPrayerMode = 'pray'; // Global variable to store prayer mode

        function generatePrayer(language, mode) {
            currentPrayerMode = mode;
<<<<<<< HEAD

            const chinesePrayPrayers = {
=======
            const chinesePrayers = {
>>>>>>> origin/main
                openings: ["在万物有灵的宇宙中", "当天地相连之时", "在自然的怀抱里", "于寂静的山水之间", "在时光的长河里", "在晨曦初现之际", "当月光洒满大地", "在四季轮转之中", "于静谧的深夜", "在万籁俱寂时", "当心灵宁静之刻", "在天地交融处"],
                subjects: ["我向石头祈祷", "我向树木祈祷", "我向流水祈祷", "我向风祈祷", "我向大地祈祷", "我向星辰祈祷", "我向山川祈祷", "我向云朵祈祷", "我向雨露祈祷", "我向花草祈祷", "我向日月祈祷", "我向万物祈祷"],
                wishes: ["愿心灵得到平静", "愿智慧如泉涌现", "愿身心和谐共存", "愿找到内在的光", "愿与万物同在", "愿感受到生命的连接", "愿灵魂得到滋养", "愿获得内心的安宁", "愿感知自然的呼吸", "愿心中充满爱与慈悲", "愿觉知生命的美好", "愿体悟万物的灵性"],
                closings: ["感恩万物的恩赐", "感谢自然的馈赠", "愿灵性之光照耀前路", "与自然同行，与万物共生", "心怀敬畏，感恩当下", "愿生命之光永不熄灭", "与天地共鸣，与万物为友", "感恩这一刻的存在", "愿心中常怀感激", "万物有灵，皆值得敬畏"]
            };

<<<<<<< HEAD
            const chineseReliefPrayers = {
                openings: ["在黑暗散去之时", "当负能量聚集之处", "于内心混沌之际", "在阴霾笼罩之时", "当心魔侵扰之刻", "在痛苦缠绕之际", "于迷茫困顿之时", "当怨念堆积之处", "在执念束缚之时", "于恐惧升起之刻", "当焦虑弥漫之际", "在创伤未愈之时"],
                subjects: ["我召唤净化之力", "我呼唤解构之能", "我引导消融之光", "我释放破除之火", "我启动涤荡之风", "我激发粉碎之雷", "我唤醒转化之水", "我开启剥离之刃", "我点燃焚烧之焰", "我发动震碎之力", "我运转洗涤之流", "我施展崩解之术"],
                wishes: ["将负面情绪化为灰烬", "让痛苦记忆随风消散", "使阴暗能量分解瓦解", "令执念枷锁粉碎破裂", "让怨恨之心溶解净化", "使恐惧之源燃烧殆尽", "令焦虑之根连根拔起", "让悲伤之雾烟消云散", "使创伤之链彻底断裂", "令迷惘之念归于虚无", "让束缚之力土崩瓦解", "使负担之重沉入深渊"],
                closings: ["愿轻盈取代沉重", "愿光明驱散黑暗", "愿新生替代腐朽", "愿自由冲破牢笼", "愿清明洗净混沌", "愿平静抚平波澜", "愿重生超越毁灭", "愿解脱战胜束缚", "愿空灵填补空虚", "愿纯净驱逐污浊"]
            };

            const englishPrayPrayers = {
=======
            const englishPrayers = {
>>>>>>> origin/main
                openings: ["In the universe where all things have spirit", "When heaven and earth unite", "In nature's embrace", "Among silent mountains and waters", "In the river of time", "At the break of dawn", "Under the moonlit sky", "Through the turning of seasons", "In the stillness of night", "When all is quiet", "In moments of inner peace", "Where heaven and earth meet"],
                subjects: ["I pray to the stones", "I pray to the trees", "I pray to the flowing water", "I pray to the wind", "I pray to the earth", "I pray to the stars", "I pray to the mountains", "I pray to the clouds", "I pray to the rain", "I pray to the flowers", "I pray to the sun and moon", "I pray to all living things"],
                wishes: ["May my spirit find peace", "May wisdom flow like a spring", "May body and mind exist in harmony", "May I find the inner light", "May I be one with all things", "May I feel the connection of life", "May my soul be nourished", "May I find serenity within", "May I sense nature's breath", "May my heart be filled with love and compassion", "May I perceive life's beauty", "May I understand the spirit of all beings"],
                closings: ["Gratitude for the gifts of all things", "Thanks for nature's blessings", "May spiritual light illuminate the path", "Walk with nature, coexist with all beings", "With reverence, grateful for the present", "May the light of life never fade", "In harmony with heaven and earth, befriend all things", "Grateful for this moment of existence", "May gratitude always fill my heart", "All things have spirit, all deserve reverence"]
            };

<<<<<<< HEAD
            const englishReliefPrayers = {
                openings: ["As darkness begins to fade", "Where negative energy gathers", "In moments of inner chaos", "When shadows loom heavy", "As demons of the mind arise", "In times of pain's embrace", "When confusion clouds the way", "Where resentment accumulates", "In the grip of attachment", "As fear takes root", "When anxiety fills the air", "In the presence of unhealed wounds"],
                subjects: ["I summon the power of purification", "I invoke the force of deconstruction", "I channel the light of dissolution", "I release the fire of destruction", "I unleash the wind of cleansing", "I activate the thunder of shattering", "I awaken the water of transformation", "I open the blade of separation", "I ignite the flame of burning", "I deploy the force of breaking", "I turn the current of washing", "I cast the art of disintegration"],
                wishes: ["Turn negative emotions into ashes", "Let painful memories scatter in the wind", "Dissolve and decompose dark energy", "Shatter the shackles of obsession", "Melt away the heart of resentment", "Burn the source of fear to nothing", "Uproot anxiety from its foundation", "Let the fog of sorrow dissipate", "Break the chains of trauma completely", "Return confusion to nothingness", "Let binding forces crumble to dust", "Sink the weight of burdens into the abyss"],
                closings: ["May lightness replace heaviness", "May brightness dispel darkness", "May rebirth replace decay", "May freedom break through imprisonment", "May clarity cleanse chaos", "May calmness smooth turbulence", "May renewal transcend destruction", "May liberation conquer bondage", "May spaciousness fill emptiness", "May purity expel pollution"]
            };

            let prayerElements;
            if (mode === 'pray') {
                prayerElements = language === 'zh' ? chinesePrayPrayers : englishPrayPrayers;
            } else {
                prayerElements = language === 'zh' ? chineseReliefPrayers : englishReliefPrayers;
            }

=======
>>>>>>> origin/main
            // Hide video and show black background immediately
            document.getElementById('backgroundVideo').style.display = 'none';
            document.querySelector('.video-overlay').style.display = 'none';
            document.querySelector('.prayer-container').style.background = '#000000';

<<<<<<< HEAD
=======
            const prayerElements = language === 'zh' ? chinesePrayers : englishPrayers;
>>>>>>> origin/main
            const opening = prayerElements.openings[Math.floor(Math.random() * prayerElements.openings.length)];
            const subject = prayerElements.subjects[Math.floor(Math.random() * prayerElements.subjects.length)];
            const wish = prayerElements.wishes[Math.floor(Math.random() * prayerElements.wishes.length)];
            const closing = prayerElements.closings[Math.floor(Math.random() * prayerElements.closings.length)];

            const separator = language === 'zh' ? '，' : ', ';
            const period = language === 'zh' ? '。' : '.';
            const prayer = `${opening}${separator}${subject}${separator}${wish}${period}${closing}${period}`;

            const prayButtons = document.getElementById('prayButtons');
            prayButtons.style.opacity = '0';

            setTimeout(() => {
                prayButtons.style.display = 'none';
                const prayerTextDiv = document.getElementById('prayerText');
                prayerTextDiv.style.display = 'flex';
                prayerTextDiv.innerHTML = `<p>${prayer}</p>`;
                prayerTextDiv.style.opacity = '0';

                document.getElementById('additionalInput').style.display = 'block';

                setTimeout(() => {
                    prayerTextDiv.style.transition = 'opacity 0.8s ease-in';
                    prayerTextDiv.style.opacity = '1';

                    setTimeout(() => {
<<<<<<< HEAD
                        const elementWheel = document.getElementById('elementWheel');
                        elementWheel.style.display = 'block';
                        wheelRotating = true;
                        initElementWheelInteractions();
                        animateElementWheel();
=======
                        const elementButtons = document.getElementById('elementButtons');
                        elementButtons.style.display = 'block';
                        elementButtons.style.opacity = '0';
                        setTimeout(() => {
                            elementButtons.style.transition = 'opacity 0.5s ease-in';
                            elementButtons.style.opacity = '1';
                        }, 100);
>>>>>>> origin/main
                    }, 800);
                }, 100);
            }, 300);
        }

        function connectWithElement(element) {
            const generatedText = document.getElementById('prayerText').querySelector('p').textContent;
            const additionalInput = document.getElementById('additionalPrayer').value.trim();
            const combinedText = additionalInput ? generatedText + ' ' + additionalInput : generatedText;

            document.getElementById('prayerOverlay').classList.add('hidden');
            document.getElementById('prayAgainButton').style.display = 'block';
            setTimeout(() => {
                document.getElementById('prayAgainButton').style.opacity = '1';
            }, 100);

            // Map elements to effect types
            let effectType;
            if (currentPrayerMode === 'pray') {
                // Uplifting elemental effects
                switch(element) {
                    case 'metal': effectType = 'metal'; break;
                    case 'wood': effectType = 'wood'; break;
                    case 'water': effectType = 'water'; break;
                    case 'fire': effectType = 'fire'; break;
                    case 'earth': effectType = 'earth'; break;
                }
            } else {
                // Destructive elemental effects for relief
                switch(element) {
                    case 'metal': effectType = 'shatter'; break;
                    case 'wood': effectType = 'wood-break'; break;
                    case 'water': effectType = 'flood'; break;
                    case 'fire': effectType = 'burn'; break;
                    case 'earth': effectType = 'earth-crack'; break;
                }
            }

            createParticles(combinedText, effectType);
            animate();
        }

        function restartPrayer() {
            const prayButtons = document.getElementById('prayButtons');
            const prayerOverlay = document.getElementById('prayerOverlay');
            const prayAgainButton = document.getElementById('prayAgainButton');

            // Show video and overlay again
            document.getElementById('backgroundVideo').style.display = 'block';
            document.querySelector('.video-overlay').style.display = 'block';
            document.querySelector('.prayer-container').style.background = 'linear-gradient(135deg, #1a1a2e 0%, #0f3460 50%, #16213e 100%)';

            prayAgainButton.style.opacity = '0';
            setTimeout(() => {
                prayAgainButton.style.display = 'none';
                prayerOverlay.classList.remove('hidden');
                document.getElementById('prayerText').style.display = 'none';
                document.getElementById('additionalInput').style.display = 'none';
<<<<<<< HEAD
                document.getElementById('elementWheel').style.display = 'none';
                document.getElementById('additionalPrayer').value = '';

                // Stop wheel rotation
                wheelRotating = false;
                if (wheelAnimationId) cancelAnimationFrame(wheelAnimationId);

=======
                document.getElementById('elementButtons').style.display = 'none';
                document.getElementById('additionalPrayer').value = '';

>>>>>>> origin/main
                prayButtons.style.display = 'flex';
                prayButtons.style.opacity = '0';
                setTimeout(() => {
                    prayButtons.style.transition = 'opacity 0.5s ease-in';
                    prayButtons.style.opacity = '1';
                }, 100);
            }, 300);
        }
    </script>
</body>
</html>